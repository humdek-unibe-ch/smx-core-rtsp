/**
 * @author  ADD AUTHOR NAME
 * @file    <box_name>.h
 *
 * This file holds custom definitions for the streamix box <box_name>.
 *
 * ADD DESCRITPTION HERE
 *
 * Use this file to define the state structure as well as auxilary functions.
 * The state structure allows to keep persistent information during net
 * iterations.
 *
 * The state structure must be allocated and initialized in the function
 * <box_name>_init() and freed in the function <box_name>_free().
 */

#include "<box_name>_sig.h"

#ifndef BOX_<box_name>_H
#define BOX_<box_name>_H

/** ::<box_name>_state_s */
typedef struct <box_name>_state_s <box_name>_state_t;

/**
 * The state structure of <box_name>.
 */
struct <box_name>_state_s
{
    // ADD STATE FIELDS
};

/**
 * This function is the start routine which is passed to the thread. It
 * performs the work of the net. The function is executed periodically until
 * all consumers or producers of the net have terminated or SMX_NET_END is
 * returned.
 *
 * @param h
 *  A pointer to the net handler. This handler must be passed to most streamix
 *  macros but must not be modified.
 * @param state
 *  A pointer to the state variable of the net. This state variable must be
 *  allocated in <box_name>_init() and freed in <box_name>_cleanup().
 * @return
 *  Either of the following values:
 *  - SMX_NET_RETURN: the RTS determines when the net is terminated.
 *  - SMX_NET_CONTINUE: forces the net to continue to operate.
 *  - SMX_NET_END: forces the net to terminate after the current iteration.
 */
int <box_name>( void* h, void* state );

/**
 * The cleanup function of the net. This function is executed once the net has
 * terminated (either automatically by the RTS or by returning SMX_NET_END in
 * <box_name>()).
 *
 * @param h
 *  A pointer to the net handler. This handler must be passed to most streamix
 *  macros but must not be modified.
 * @param state
 *  A pointer to the state variable of the net. This state variable must be
 *  freed here if it was allocated in <box_name>_init().
 */
void <box_name>_cleanup( void* h, void* state );

/**
 * The initialisation function of the net. This function is executed before the
 * net thread is started. All nets have to complete their initialisation before
 * any net thread is started. This function must initialise the state variable
 * and assign initial values to fields as needed.
 *
 * @param h
 *  A pointer to the net handler. This handler must be passed to most streamix
 *  macros but must not be modified.
 * @param state
 *  A pointer to the state variable pointer. To access the state variable
 *  pointer dereference this argument (i.e. *state = ...)
 * @return
 *  If the initialisation succeedes return 0. If the initialisation fails,
 *  return -1.  Returning -1 will terminate (or rather never execute) the net.
 */
int <box_name>_init( void* h, void** state );

/**
 * This function is predefined and must not be changed. It will be passed to the
 * net thread upon creation and will be executed as soon as the thread is
 * started. This function calls a macro which is defined in the RTS and handles
 * the initialisation, the main loop and the cleanup of the net.
 *
 * @param h
 *  A pointer to the net handler.
 * @return
 *  This function always returns NULL.
 */
void* start_routine_<box_name>( void* h );

#endif
